Algo seems ok but fails on 64bit integers because of PHP limitations.
In theory can be solved by 
http://php.net/manual/en/book.bc.php
and
http://cct.me.ntut.edu.tw/ccteducation/chchting/aiahtm/computer/phphelp/ref.bc.php.htm